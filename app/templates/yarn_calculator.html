<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yarn Usage Estimator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/yarn_calculator.css') }}">
  
</head>
<body>

    <div class="header-bar">
        <h1 class="page-title">
          Yarn Usage Estimator
        </h1>
        
        <label class="theme-switch" aria-label="Toggle dark mode">
          <input type="checkbox" id="theme-toggle">
          <span class="slider">
            <span class="moon"></span>
          </span>
        </label>
    </div>

  <div class="container-fluid main-container">
    <div class="row g-4 justify-content-center">
      <div class="col-lg-5 col-md-6">
        <div class="upload-card">
          <div class="card-header">
            <h2>Upload Your Crochet Project</h2>
            <h6>Transform your crochet pattern into yarn calculations</h6>
          </div>
          <div class="sample-divider"></div>
          <form id="yarn-form" method="post" enctype="multipart/form-data">
            <div class="form-group">
              <label class="form-label">
                Select Yarn Thickness
              </label>
              <div class="thickness-selector">
                <input type="radio" name="thickness" value="Thin" id="thin" class="thickness-radio">
                <label for="thin" class="thickness-option">
                  <div class="thickness-preview thin-preview"></div>
                  <span>Thin</span>
                  <small><br>Sport weight</small>
                </label>
                
                <input type="radio" name="thickness" value="Medium" id="medium" class="thickness-radio" checked>
                <label for="medium" class="thickness-option">
                  <div class="thickness-preview medium-preview"></div>
                  <span>Medium</span>
                  <small> <br>Worsted weight</small>
                </label>
                
                <input type="radio" name="thickness" value="Thick" id="thick" class="thickness-radio">
                <label for="thick" class="thickness-option">
                  <div class="thickness-preview thick-preview"></div>
                  <span>Thick</span>
                  <small><br>Chunky weight</small>
                </label>
              </div>
            </div>

            <div class="form-group">
              <div class="sample-divider"></div>
              <label class="form-label">
                Upload Image
              </label>
              <div class="file-upload-wrapper">
                <input type="file" name="image" id="image-input" accept="image/*" class="file-input">
                <div class="file-upload-area" id="file-upload-area">
                  <div class="upload-content">
                    <i class="fas fa-cloud-upload-alt upload-cloud" aria-hidden="true"></i>
                    <h4>Drop your image here</h4>
                    <p>or <span class="browse-text">browse files</span></p>
                    <small>Supports JPG, PNG, GIF up to 10MB</small>
                  </div>
                  <div class="file-preview" id="file-preview" style="display: none;">
                    <img id="preview-image" src="data:image/png;base64,AAAA…" alt="Uploaded photo">
                    <div class="file-info">
                      <span id="file-name"></span>
                      <button type="button" class="remove-file" id="remove-file">
                        <i class="fas fa-times" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            <button id="submit-button" type="submit" class="submit-btn">
              <span class="submit-content">
                <span class="submit-text">Analyze Project</span>
              </span>
              <span class="loading-content" style="display: none;">
                <div class="spinner"></div>
                <span>Processing...</span>
              </span>
            </button>
              <!-- Sample Images Section -->
              <div class="sample-section">
                <div class="sample-divider">
                  <span>or try with a sample image</span>
                </div>
                <div class="sample-images">
                  <div class="sample-image" data-sample="granny-square" style="cursor: pointer; transition: transform 0.2s ease; border-radius: 8px; overflow: hidden;">
                    <img src="./static/images/granny-square.jpg" alt="Example 1">
                  </div>
                  <div class="sample-image" data-sample="flower" style="cursor: pointer; transition: transform 0.2s ease; border-radius: 8px; overflow: hidden;">
                    <img src="./static/images/flower.jpg" alt="Example 2" style="width: 100%; height: 100%; object-fit: cover;">
                  </div>
                  <div class="sample-image" data-sample="star" style="cursor: pointer; transition: transform 0.2s ease; border-radius: 8px; overflow: hidden;">
                    <img src="./static/images/star.jpg" alt="Example 3" style="width: 100%; height: 100%; object-fit: cover;">
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="col-lg-6 col-md-6">
        <div class="results-card" id="results-container">
          {% if original %}
          <div class="results-content">
            <div class="results-header">
              <i class="fas fa-chart-line" aria-hidden="true"></i>
              <h3>Analysis Results</h3>
            </div>
            
             
            <div class="stitch-breakdown">
              <h4><i class="fas fa-list-ul" aria-hidden="true"></i> Stitch Breakdown</h4>
              <div class="stitch-list">
                {% for cls, count in stitch_counts.items() %}
                <div class="stitch-item">
                  <span class="stitch-type">{{ cls }}</span>
                  <span class="stitch-count">{{ count }}×</span>
                </div>
                {% endfor %}
              </div>
            </div>

            <div class="image-comparison">
              <div class="comparison-tabs">
                <button class="tab-btn active" data-tab="processed">
                  <i class="fas fa-search" aria-hidden="true"></i> Detected Stitches
                </button>
                <button class="tab-btn" data-tab="original">
                  <i class="fas fa-image" aria-hidden="true"></i> Original
                </button>
              </div>
              
              <div class="image-container">
                <div class="tab-content active" id="processed-tab">
                  <img src="data:image/png;base64,{{ processed }}" alt="Processed image" class="result-image">
                </div>
                <div class="tab-content" id="original-tab">
                  <img src="data:image/jpeg;base64,{{ original }}" alt="Original image" class="result-image">
                </div>
              </div>
            </div>
          </div>
          {% else %}
          <div class="empty-state">
            <h5>Upload your crochet project image to get detailed yarn usage estimates and stitch detection.</h5>
            <div class="features-list">
              <div class="feature">
                <i class="fas fa-eye" aria-hidden="true"></i>
                <span>Automatic stitch detection</span>
              </div>
              <div class="feature">
                <i class="fas fa-calculator" aria-hidden="true"></i>
                <span>Precise yarn calculations</span>
              </div>
              <div class="feature">
                <i class="fas fa-chart-bar" aria-hidden="true"></i>
                <span>Detailed breakdowns</span>
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/yarn_calculator.js') }}"></script>

</body>
</html>